<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/order-service/src/main/java/sn/dev/order_service/services/SubOrderService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/order-service/src/main/java/sn/dev/order_service/services/SubOrderService.java" />
              <option name="originalContent" value="package sn.dev.order_service.services;&#10;&#10;import org.springframework.data.domain.Page;&#10;import org.springframework.data.domain.Pageable;&#10;import sn.dev.order_service.data.entities.SubOrder;&#10;&#10;import java.util.List;&#10;&#10;public interface SubOrderService {&#10;    SubOrder getById(String id);&#10;&#10;    List&lt;SubOrder&gt; getBySellerId(String sellerId);&#10;&#10;    SubOrder updateStatus(String id, String status);&#10;&#10;    Page&lt;SubOrder&gt; getSubOrdersBySeller(String sellerId, String status, Pageable pageable);&#10;}&#10;" />
              <option name="updatedContent" value="package sn.dev.order_service.services;&#10;&#10;import org.springframework.data.domain.Page;&#10;import org.springframework.data.domain.Pageable;&#10;import sn.dev.order_service.data.entities.SubOrder;&#10;&#10;import java.util.List;&#10;&#10;public interface SubOrderService {&#10;    SubOrder getById(String id);&#10;&#10;    List&lt;SubOrder&gt; getBySellerId(String sellerId);&#10;&#10;    SubOrder updateStatus(String id, String status);&#10;&#10;    Page&lt;SubOrder&gt; getSubOrdersBySeller(String sellerId, String status, Pageable pageable);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/order-service/src/main/java/sn/dev/order_service/services/impl/SubOrderServiceImpl.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/order-service/src/main/java/sn/dev/order_service/services/impl/SubOrderServiceImpl.java" />
              <option name="originalContent" value="package sn.dev.order_service.services.impl;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.data.domain.Page;&#10;import org.springframework.data.domain.PageRequest;&#10;import org.springframework.data.domain.Pageable;&#10;import org.springframework.data.domain.Sort;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.web.server.ResponseStatusException;&#10;import sn.dev.order_service.data.entities.SubOrder;&#10;import sn.dev.order_service.data.repository.SubOrderRepository;&#10;import sn.dev.order_service.services.SubOrderService;&#10;import java.util.List;&#10;@Slf4j&#10;@Service&#10;@RequiredArgsConstructor&#10;public class SubOrderServiceImpl implements SubOrderService {&#10;    private final SubOrderRepository subOrderRepository;&#10;    @Override&#10;    public SubOrder getById(String id) {&#10;        return subOrderRepository.findById(id)&#10;                .orElseThrow(() -&gt; new ResponseStatusException(&#10;                        HttpStatus.NOT_FOUND,&#10;                        &quot;SubOrder not found with id: &quot; + id&#10;                ));&#10;    }&#10;    @Override&#10;    public List&lt;SubOrder&gt; getBySellerId(String sellerId) {&#10;        return subOrderRepository.findBySellerId(sellerId);&#10;    }&#10;    @Override&#10;    public SubOrder updateStatus(String id, String status) {&#10;        SubOrder subOrder = getById(id);&#10;        subOrder.setStatus(status);&#10;        subOrder.setUpdatedAt(java.time.Instant.now());&#10;        return subOrderRepository.save(subOrder);&#10;    }&#10;    @Override&#10;    public Page&lt;SubOrder&gt; getSubOrdersBySeller(String sellerId, String status, Pageable pageable) {&#10;        log.info(&quot;Fetching sub-orders for seller: {}, status: {}, page: {}, size: {}&quot;,&#10;                sellerId, status, pageable.getPageNumber(), pageable.getPageSize());&#10;        // Créer un Pageable avec tri par createdAt DESC&#10;        Pageable pageableWithSort = PageRequest.of(&#10;                pageable.getPageNumber(),&#10;                pageable.getPageSize(),&#10;                Sort.by(Sort.Direction.DESC, &quot;createdAt&quot;)&#10;        );&#10;        // Filtrer par status si fourni&#10;        if (status != null &amp;&amp; !status.isBlank()) {&#10;            return subOrderRepository.findBySellerIdAndStatus(sellerId, status, pageableWithSort);&#10;        }&#10;        return subOrderRepository.findBySellerId(sellerId, pageableWithSort);&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package sn.dev.order_service.services.impl;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.data.domain.Page;&#10;import org.springframework.data.domain.PageRequest;&#10;import org.springframework.data.domain.Pageable;&#10;import org.springframework.data.domain.Sort;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.web.server.ResponseStatusException;&#10;import sn.dev.order_service.data.entities.SubOrder;&#10;import sn.dev.order_service.data.repository.SubOrderRepository;&#10;import sn.dev.order_service.services.SubOrderService;&#10;import java.util.List;&#10;@Slf4j&#10;@Service&#10;@RequiredArgsConstructor&#10;public class SubOrderServiceImpl implements SubOrderService {&#10;    private final SubOrderRepository subOrderRepository;&#10;    @Override&#10;    public SubOrder getById(String id) {&#10;        return subOrderRepository.findById(id)&#10;                .orElseThrow(() -&gt; new ResponseStatusException(&#10;                        HttpStatus.NOT_FOUND,&#10;                        &quot;SubOrder not found with id: &quot; + id&#10;                ));&#10;    }&#10;    @Override&#10;    public List&lt;SubOrder&gt; getBySellerId(String sellerId) {&#10;        return subOrderRepository.findBySellerId(sellerId);&#10;    }&#10;    @Override&#10;    public SubOrder updateStatus(String id, String status) {&#10;        SubOrder subOrder = getById(id);&#10;        subOrder.setStatus(status);&#10;        subOrder.setUpdatedAt(java.time.Instant.now());&#10;        return subOrderRepository.save(subOrder);&#10;    }&#10;    @Override&#10;    public Page&lt;SubOrder&gt; getSubOrdersBySeller(String sellerId, String status, Pageable pageable) {&#10;        log.info(&quot;Fetching sub-orders for seller: {}, status: {}, page: {}, size: {}&quot;,&#10;                sellerId, status, pageable.getPageNumber(), pageable.getPageSize());&#10;        // Créer un Pageable avec tri par createdAt DESC&#10;        Pageable pageableWithSort = PageRequest.of(&#10;                pageable.getPageNumber(),&#10;                pageable.getPageSize(),&#10;                Sort.by(Sort.Direction.DESC, &quot;createdAt&quot;)&#10;        );&#10;        // Filtrer par status si fourni&#10;        if (status != null &amp;&amp; !status.isBlank()) {&#10;            return subOrderRepository.findBySellerIdAndStatus(sellerId, status, pageableWithSort);&#10;        }&#10;        return subOrderRepository.findBySellerId(sellerId, pageableWithSort);&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>